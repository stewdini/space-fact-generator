<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Space Fact Generator</title>
<style>
  body {
    margin: 0;
    background: #000;
    color: #eee;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    overflow: hidden;
    height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  #spaceObjectsContainer {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    pointer-events: none;
    overflow: hidden;
    z-index: 0;
  }

  .space-object {
    position: absolute;
    will-change: transform;
    filter: drop-shadow(0 0 1px #fff8);
    user-select: none;
  }

  /* Planets with subtle craters and moderate glow */
  .planet {
    border-radius: 50%;
    box-shadow:
      inset 5px 5px 7px rgba(0,0,0,0.4),
      0 0 8px rgba(255,255,255,0.15);
  }
  .planet.red {
    background:
      radial-gradient(circle at 30% 30%, #b22, #700),
      radial-gradient(circle at 70% 70%, #a00, #500);
  }
  .planet.blue {
    background:
      radial-gradient(circle at 25% 25%, #3399ff, #004080),
      radial-gradient(circle at 75% 75%, #4aaaff, #003366);
  }
  .planet.green {
    background:
      radial-gradient(circle at 20% 20%, #2a8f4f, #144d27),
      radial-gradient(circle at 80% 80%, #38b65d, #0f360f);
  }
  .planet.orange {
    background:
      radial-gradient(circle at 30% 30%, #ffa64d, #b35400),
      radial-gradient(circle at 70% 70%, #ffb366, #803d00);
  }
  .planet.purple {
    background:
      radial-gradient(circle at 25% 25%, #8a5bba, #442d7f),
      radial-gradient(circle at 75% 75%, #a67cdd, #452b7d);
  }

  /* Comets with layered linear gradients, no transparency */
  .comet {
    border-radius: 50% / 60%;
    background:
      linear-gradient(135deg, #eee 20%, #bbb 80%);
    box-shadow: 0 0 6px 1px #ccc;
  }

  /* Asteroids with irregular polygon shape */
  .asteroid {
    background:
      radial-gradient(circle at 30% 30%, #888, #444);
    clip-path: polygon(
      25% 5%, 75% 0%, 95% 25%, 85% 75%, 50% 95%, 10% 80%, 5% 40%
    );
    box-shadow: 0 0 5px 1px #555;
  }

  /* Rockets: size and glow */
  .rocket {
    width: 30px !important;
    height: 40px !important;
    background-repeat: no-repeat;
    background-size: contain;
    background-position: center;
    filter: drop-shadow(0 0 3px #fff8);
    border-radius: 4px;
  }

  #factDisplay {
    position: relative;
    z-index: 2;
    max-width: 600px;
    margin: 20px auto 0;
    text-align: center;
    font-size: 1.3rem;
    min-height: 60px;
    padding: 0 40px 0 10px;
  }

  .sparkle {
    display: inline-block;
    margin-left: 6px;
    animation: sparkleAnim 1s ease forwards;
    color: #fff8aa;
    font-size: 1.2rem;
    user-select: none;
  }
  @keyframes sparkleAnim {
    0% { opacity: 0; transform: scale(0.5) rotate(0deg); }
    50% { opacity: 1; transform: scale(1.3) rotate(20deg); }
    100% { opacity: 0; transform: scale(1) rotate(0deg); }
  }

  #buttonsContainer {
    margin-top: 15px;
    position: relative;
    z-index: 2;
  }

  #factButton {
    padding: 10px 18px;
    font-size: 1rem;
    border: none;
    border-radius: 8px;
    background: linear-gradient(45deg, #5a8cff, #3670ff);
    color: white;
    cursor: pointer;
    box-shadow: 0 0 10px #4a7ae5;
    transition: box-shadow 0.3s ease;
  }
  #factButton:hover {
    box-shadow: 0 0 18px #5a9aff;
  }

  #muteToggle {
    cursor: pointer;
    font-size: 1.4rem;
    user-select: none;
    margin-left: 12px;
    vertical-align: middle;
    color: #bbb;
  }

  #copyButton {
    cursor: pointer;
    margin-left: 12px;
    user-select: none;
    vertical-align: middle;
    font-size: 1.2rem;
    background: none;
    border: none;
    color: #ccc;
    padding: 4px 8px;
    border-radius: 6px;
    transition: background-color 0.3s ease;
  }
  #copyButton:hover {
    background-color: #555;
    color: #fff;
  }

  #copyFeedback {
    display: none;
    color: #aaffaa;
    font-size: 1rem;
    margin-left: 8px;
    vertical-align: middle;
  }
</style>
</head>
<body>

<div id="spaceObjectsContainer"></div>

<div id="factDisplay">Click the button below to learn a cool space fact!</div>

<div id="buttonsContainer">
  <button id="factButton" aria-label="Get a random space fact">Get Space Fact</button>
  <span id="muteToggle" role="button" tabindex="0" aria-pressed="false" aria-label="Toggle sound">ðŸ”Š</span>
  <button id="copyButton" title="Copy fact to clipboard" aria-label="Copy fact">ðŸ“‹</button>
  <span id="copyFeedback" aria-live="polite">âœ… Copied</span>
</div>

<script>
  // Rocket SVG images as base64 encoded inline SVGs (colorful and clear)
  const rocketImages = [
    'data:image/svg+xml;utf8,<svg width="30" height="40" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="%23FF3B30" d="M12 2L15 10L9 10L12 2Z"/><rect x="10" y="10" width="4" height="20" fill="%23FF9500"/><circle cx="12" cy="30" r="3" fill="%23FFCC00"/></svg>',
    'data:image/svg+xml;utf8,<svg width="30" height="40" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="%2300C853" d="M12 2L15 10L9 10L12 2Z"/><rect x="10" y="10" width="4" height="20" fill="%2300E676"/><circle cx="12" cy="30" r="3" fill="%2300FFA4"/></svg>',
    'data:image/svg+xml;utf8,<svg width="30" height="40" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="%230085FF" d="M12 2L15 10L9 10L12 2Z"/><rect x="10" y="10" width="4" height="20" fill="%2300A0FF"/><circle cx="12" cy="30" r="3" fill="%2300D4FF"/></svg>'
  ];

  const spaceObjectsContainer = document.getElementById('spaceObjectsContainer');

  class SpaceObject {
    constructor(type) {
      this.type = type;
      this.el = document.createElement('div');
      this.el.classList.add('space-object');

      if (type === 'planet') {
        this.size = 40 + Math.random() * 35;
        this.el.classList.add('planet');

        const planetColors = ['red', 'blue', 'green', 'orange', 'purple'];
        const color = planetColors[Math.floor(Math.random() * planetColors.length)];
        this.el.classList.add(color);

      } else if (type === 'comet') {
        this.size = 25 + Math.random() * 20;
        this.el.classList.add('comet');
      } else if (type === 'asteroid') {
        this.size = 20 + Math.random() * 20;
        this.el.classList.add('asteroid');
      } else if (type === 'rocket') {
        this.size = 30;
        this.el.classList.add('rocket');

        const rocketIndex = Math.floor(Math.random() * rocketImages.length);
        this.el.style.backgroundImage = `url(${rocketImages[rocketIndex]})`;
      }

      this.el.style.width = this.size + 'px';
      this.el.style.height = (this.type === 'rocket' ? 40 : this.size) + 'px';

      // Start from random edge with inward movement
      const edge = Math.floor(Math.random() * 4);
      switch(edge) {
        case 0: // Top
          this.x = Math.random() * window.innerWidth;
          this.y = -this.size - 10;
          this.speedX = (Math.random() - 0.5) * 0.3;
          this.speedY = Math.random() * 0.3 + 0.05; // down
          break;
        case 1: // Right
          this.x = window.innerWidth + this.size + 10;
          this.y = Math.random() * window.innerHeight;
          this.speedX = -(Math.random() * 0.3 + 0.05); // left
          this.speedY = (Math.random() - 0.5) * 0.3;
          break;
        case 2: // Bottom
          this.x = Math.random() * window.innerWidth;
          this.y = window.innerHeight + this.size + 10;
          this.speedX = (Math.random() - 0.5) * 0.3;
          this.speedY = -(Math.random() * 0.3 + 0.05); // up
          break;
        case 3: // Left
          this.x = -this.size - 10;
          this.y = Math.random() * window.innerHeight;
          this.speedX = Math.random() * 0.3 + 0.05; // right
          this.speedY = (Math.random() - 0.5) * 0.3;
          break;
      }

      this.rotation = Math.random() * 360;
      this.rotationSpeed = (Math.random() - 0.5) * 0.1;

      spaceObjectsContainer.appendChild(this.el);
    }

    update() {
      this.x += this.speedX;
      this.y += this.speedY;

      if (this.x < -this.size) this.x = window.innerWidth + this.size;
      else if (this.x > window.innerWidth + this.size) this.x = -this.size;

      if (this.y < -this.size) this.y = window.innerHeight + this.size;
      else if (this.y > window.innerHeight + this.size) this.y = -this.size;

      this.rotation += this.rotationSpeed;
      if (this.rotation > 360) this.rotation -= 360;
      if (this.rotation < 0) this.rotation += 360;

      this.el.style.transform = `translate(${this.x}px, ${this.y}px) rotate(${this.rotation}deg)`;
    }
  }

  const spaceObjects = [];
  const totalObjects = 20;

  for(let i=0; i<totalObjects; i++) {
    let type;
    const rand = Math.random();
    if (rand < 0.05) type = 'rocket';
    else if (rand < 0.30) type = 'comet';
    else if (rand < 0.55) type = 'asteroid';
    else type = 'planet';

    spaceObjects.push(new SpaceObject(type));
  }

  function animateSpaceObjects() {
    spaceObjects.forEach(obj => obj.update());
    requestAnimationFrame(animateSpaceObjects);
  }

  animateSpaceObjects();

  // Fact generator
  let facts = [];
  let previousIndex = -1;

  const factDisplay = document.getElementById('factDisplay');
  const factButton = document.getElementById('factButton');
  const copyButton = document.getElementById('copyButton');
  const copyFeedback = document.getElementById('copyFeedback');
  const muteToggle = document.getElementById('muteToggle');

  let isMuted = false;

  // Pop sound (clean pop)
  const popSound = new Audio('https://cdn.pixabay.com/download/audio/2022/03/26/audio_ebaf1f29de.mp3?filename=pop-6167.mp3');
  popSound.volume = 0.3;

  fetch('https://raw.githubusercontent.com/stewdini/space-fact-generator/main/facts.json')
    .then(response => {
      if (!response.ok) throw new Error('Network response was not OK');
      return response.json();
    })
    .then(data => {
      if (Array.isArray(data) && data.length) {
        facts = data;
      } else {
        factDisplay.textContent = "Oops! No facts found in the data.";
      }
    })
    .catch(err => {
      factDisplay.textContent = "Oops! Could not load facts right now.";
      console.error('Failed to load facts:', err);
    });

  function getRandomFactIndex() {
    let idx;
    do {
      idx = Math.floor(Math.random() * facts.length);
    } while (idx === previousIndex && facts.length > 1);
    previousIndex = idx;
    return idx;
  }

  factButton.addEventListener('click', () => {
    if (facts.length === 0) {
      factDisplay.textContent = "No facts available. Try again later.";
      copyButton.style.display = 'none';
      return;
    }

    if (!isMuted) popSound.play().catch(() => {});

    const idx = getRandomFactIndex();
    factDisplay.textContent = facts[idx];

    copyButton.style.display = 'inline-flex';
    copyFeedback.style.display = 'none';

    const sparkle = document.createElement('span');
    sparkle.className = 'sparkle';
    factDisplay.appendChild(sparkle);
  });

  copyButton.addEventListener('click', () => {
    if (factDisplay.textContent.trim() && factDisplay.textContent !== "Click the button below to learn a cool space fact!") {
      navigator.clipboard.writeText(factDisplay.textContent.replace('âœ¨', '').trim());
      copyFeedback.style.display = 'inline';
      setTimeout(() => {
        copyFeedback.style.display = 'none';
      }, 1500);
    }
  });

  muteToggle.addEventListener('click', () => {
    isMuted = !isMuted;
    muteToggle.textContent = isMuted ? 'ðŸ”‡' : 'ðŸ”Š';
    muteToggle.setAttribute('aria-pressed', isMuted.toString());
  });

  copyButton.style.display = 'none';
</script>
</body>
</html>
